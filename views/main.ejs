<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <title>Document</title>
    <link rel="stylesheet" href="/public/css/main.css" />
    <link
      rel="canonical"
      href="https://getbootstrap.com/docs/5.3/examples/album/"
    />
    <!-- <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
      crossorigin="anonymous"
    /> -->
  </head>
  <body>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const loginBar = document.querySelector(".loginOrLogoutBtn");
        const loginCheck = sessionStorage.getItem("token");
        if (loginCheck) {
          const logoutButton = document.createElement("a");
          logoutButton.href = "#"; //클릭시 logout함수 호출
          logoutButton.textContent = "로그아웃";
          logoutButton.classList.add("logout");
          loginBar.appendChild(logoutButton);
          logoutButton.addEventListener("click", logout);
        } else {
          const logintButton = document.createElement("a");
          logintButton.href = "/signin";
          logintButton.textContent = "로그인";
          logintButton.classList.add("signin");
          loginBar.appendChild(logintButton);
        }
        function logout() {
          sessionStorage.removeItem("token");
          window.location.href = "/main";
        }
      });
    </script>
    <div class="topBarBg">
      <div class="topBar">
        <p><a class="howsParty" href="/main"> How's Party </a></p>
        <div class="topBar-right">
          <p>
            <a href="/parties"
              ><img src="../../public/img/parties.svg" alt="" /><b
                >파티목록</b
              ></a
            >
          </p>
          <p>
            <a href="/chat"
              ><img src="../../public/img/chat.svg" alt="" /><b>채팅</b></a
            >
          </p>
          <p>
            <a href="/profile"
              ><img src="../../public/img/user.svg" alt="" /><b
                >마이페이지</b
              ></a
            >
          </p>
          <p class="loginOrLogoutBtn"></p>
        </div>
      </div>
    </div>

    <img src="/public/img/mainhome.png" alt="home image" class="mainHome" />

    <script>
      (function () {
        let result1 = "";
        const local = sessionStorage.getItem("token");
        console.log(local);
        const currentUrl = window.location.href;
        console.log(currentUrl);
        if (local != null) {
          axios({
            method: "post",
            url: `/verify`,
            data: {
              token: local,
            },
          }).then((result) => {
            result1 = result;
            console.log(result1.data.user.id);
          });
        } else {
          console.log("로그인 실패");
        }
      })();
    </script>
  </body>
</html>
