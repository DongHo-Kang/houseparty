<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/public/css/find.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <title>Document</title>
  </head>
  <body>
    <div class="container">
      <div class="topBar">
        <a class="howsParty" href="/main"> How's Party </a
        ><a class="signin" href="/signin">login</a>
      </div>
      <span id="find_title_id">아이디 찾기</span>
      <form name="findIdForm">
        <div class="top">
          <div class="nameBox">
            <img src="/public/img/id.svg" />
            <input
              type="text"
              name="name"
              id="name"
              class="name"
              placeholder="이름"
            />
          </div>
          <div class="birthBox">
            <img src="/public/img/birth.svg" />
            <input
              type="date"
              name="birth"
              id="birth"
              class="birth"
              placeholder="생년월일"
            />
          </div>
          <div class="phoneBox">
            <img src="/public/img/phone.svg" />
            <input
              type="number"
              name="phone_number"
              id="phone_number"
              class="phoneNumber"
              placeholder="휴대전화 번호"
            />
          </div>
          <br />
          <button
            type="button"
            id="findId"
            class="findId"
            onclick="findIdFunc()"
          >
            찾기
          </button>
        </div>
      </form>

      <div id="findIdResult" class="findIdResult">
        회원님 아이디는 ~~~입니다.
      </div>

      <span id="find_title_pw">비밀번호 찾기</span>
      <form name="findPwForm">
        <div class="top">
          <div class="nameBox">
            <img src="/public/img/id.svg" />
            <input
              type="text"
              name="name"
              id="name"
              class="name"
              placeholder="이름"
            />
          </div>
          <div class="idBox">
            <img src="/public/img/id.svg" />
            <input
              type="text"
              name="id"
              id="id"
              class="id"
              placeholder="아이디"
            />
          </div>
          <div class="birthBox">
            <img src="/public/img/birth.svg" />
            <input
              type="date"
              name="birth"
              id="birth"
              class="birth"
              placeholder="생년월일"
            />
          </div>
          <div class="phoneBox">
            <img src="/public/img/phone.svg" />
            <input
              type="number"
              name="phone_number"
              id="phone_number"
              class="phoneNumber"
              placeholder="휴대전화 번호"
            />
          </div>
          <br />
          <button
            type="button"
            id="findId"
            class="findId"
            onclick="findPwFunc()"
          >
            찾기
          </button>
        </div>
      </form>
      <div class="findPwResult">회원님 비밀번호는 ~~~입니다.</div>
    </div>
  </body>
  <script>
    async function findIdFunc() {
      const form = document.forms["findIdForm"];
      const birth = `${form.birth.value} 00:00:00`;
      const findIdResult = document.getElementById("findIdResult");
      console.log("form", form.name.value);
      console.log("form birth", birth);
      console.log("form phone", form.phone_number.value);
      if (
        form.name.value === "" ||
        form.birth.value === "" ||
        form.phone_number === ""
      ) {
        alert("필수항목을 다 입력해주세요.");
      } else {
        try {
          const res = await axios.post("/find/findId", {
            name: form.name.value,
            birth: birth,
            phone_number: form.phone_number.value,
          });
          console.log("결과 받아옴", res);
          // findIdResult.textContent = `회원님의 아이디는 ${res.data.findId}입니다.`;
        } catch (err) {
          console.log(err);
        }
      }
    }

    async function findPwFunc() {
      const form = document.forms["findPwForm"];
      const findPwResult = document.getElementById("findPwResult");

      if (
        form.name.value === "" ||
        form.id.value === "" ||
        form.birth.value === "" ||
        form.phone_number.value === ""
      ) {
        alert("항목을 다 입력해주세요.");
      } else {
        try {
          const res = await axios.post("/find/findPw", {
            name: form.name.value,
            id: form.id.value,
            birth: form.birth.value,
            phone_number: form.phone_number.value,
          });
        } catch (err) {
          console.log(err);
        }
      }
    }
  </script>
</html>
